# Discord Bot

Многофункциональный Discord бот с возможностями музыкального плеера и системой автоматической выдачи ролей.

## Основные возможности

### Музыкальный плеер
- `/play [URL/название]` - воспроизведение музыки с YouTube
- `/skip` - пропуск текущего трека
- `/stop` - остановка воспроизведения
- `/queue` - просмотр очереди воспроизведения
- `/repeat` - включение/выключение повтора
- `/nowplaying` - информация о текущем треке
- `/clearplaylist` - очистка плейлиста

### Система ролей
- `!role [channel_id] [role_id] [emoji_id]` - добавление правила автовыдачи роли
- `!del_role [index]` - удаление правила по индексу
- `!del_role all` - удаление всех правил
- Автоматическая выдача ролей при реакции на сообщение
### Общие команды
- `/ping` - проверка работоспособности бота
- `/rules` - отображение правил сервера
- `/info` - информация о сервере
- `/hello` - приветственное сообщение
- `/invite` - получение ссылки-приглашения

### Команды конфигурации
- `!token [token]` - установка токена бота
- `!id` - установка ID администратора
- `!id_del` - удаление ID администратора
- `!link [url]` - установка ссылки приглашения
- `!read_conf` - просмотр текущей конфигурации

## Установка и настройка

### Системные требования
- Java 11 или выше
- Maven для сборки проекта
- Discord Bot Token

### Сборка проекта
```bash
mvn clean package
```

Собранный JAR-файл будет находиться в директории `target/DiscordjBot-1.0-jar-with-dependencies.jar`

### Конфигурация
При первом запуске автоматически создается файл `config.json` со следующей структурой:

```json
{
  "token": "empty",
  "owner": "empty",
  "inviteLink": "empty",
  "roles": [
    {
      "channelId": "empty",
      "roleId": "empty",
      "emojiId": "empty"
    }
  ]
}
```

#### Способы настройки токена (в порядке приоритета):
1. Аргумент командной строки при запуске
2. Переменная окружения `TOKEN`
3. Значение в `config.json`

### Запуск
```bash
java -jar target/DiscordjBot-1.0-jar-with-dependencies.jar [token]
```

## Настройка автовыдачи ролей

1. Создайте роль на сервере Discord
2. Получите необходимые ID:
   - ID канала (ПКМ по каналу → Копировать ID)
   - ID роли (Настройки сервера → Роли → Копировать ID)
   - ID эмодзи (Поставьте эмодзи и скопируйте его)
3. Добавьте правило командой:
   ```
   !role channel_id role_id emoji_id
   ```
   ## Используемые технологии

### Основные библиотеки
- JDA (Java Discord API) 5.2.1 - основной фреймворк для работы с Discord
- LavaPlayer 2.2.2 - библиотека для воспроизведения аудио
- Jackson 2.13.4.2 - работа с JSON
- SLF4J и Logback - логирование

### Функциональные возможности
- Воспроизведение музыки с YouTube
- Система автоматической выдачи ролей
- Конфигурация через JSON
- Управление через slash-команды и текстовые команды

### Особенности реализации
- Паттерн Singleton для работы с конфигурацией
- Потокобезопасная обработка конфигурации
- Автоматическое создание и обновление конфигурации
- Форматированный вывод через Embed сообщения

## Разработка

### Структура проекта
```
src/
├── main/
│   ├── java/ru/discordj/bot/
│   │   ├── config/
│   │   ├── events/
│   │   ├── embed/
│   │   └── lavaplayer/
│   └── resources/
└── config.json
```

### Сборка проекта
Проект использует Maven для управления зависимостями и сборки:
- Автоматическое включение зависимостей
- Копирование ресурсов
- Создание исполняемого JAR-файла

## Примечания
- Конфигурационный файл создается автоматически при первом запуске
- Поддерживается ручное редактирование config.json
- Все изменения конфигурации сохраняются автоматически
- Бот поддерживает работу на нескольких серверах одновременно